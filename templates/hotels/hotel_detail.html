{% extends 'base2.html' %}
{% load static %}

{% block title %}{{ hotel.get_public_name }}{% endblock %}

{% block content %}
<!-- Toast Notifications - Place at the beginning of content -->
<div class="toast-container position-fixed bottom-0 start-0 p-3">
  <div id="successToast" class="toast align-items-center text-white bg-success border-0" role="alert">
    <div class="d-flex">
      <div class="toast-body">Thank you for your review!</div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
    </div>
  </div>
</div>

<div class="toast-container position-fixed bottom-0 start-0 p-3">
  <div id="errorToast" class="toast align-items-center text-white bg-danger border-0" role="alert">
    <div class="d-flex">
      <div class="toast-body" id="errorToastMessage">There was an error submitting your review.</div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
    </div>
  </div>
</div>




<!-- Hero Section -->
<div class="position-relative">
    {% if hotel.image %}
        <div class="hotel-hero-image" style="background-image: url('{{ hotel.image.url }}');"></div>
    {% else %}
        <div class="hotel-hero-image" style="background-image: url('{% static 'images/default-hotel.jpg' %}');"></div>
    {% endif %}
    <div class="hotel-hero-overlay"></div>
    <div class="container position-relative">
        <div class="hotel-hero-content">
            <h1 class="display-4 fw-bold text-white mb-2">{{ hotel.get_public_name }}</h1>
            <!-- Average Rating -->
{% if hotel.average_rating %}
  <div class="d-flex align-items-center mb-2">
    <div class="text-warning me-2">
      {% for i in "12345"|make_list %}
  {% if hotel.average_rating|floatformat:0 >= i|add:"0"|floatformat:0 %}
    <i class="fas fa-star text-warning"></i>
  {% else %}
    <i class="far fa-star text-warning"></i>
  {% endif %}
{% endfor %}

    </div>
    <span class="text-white small">
      {{ hotel.average_rating|floatformat:1 }} stars
    </span>
  </div>
{% endif %}
            <div class="d-flex align-items-center text-white mb-3">
                <i class="fas fa-map-marker-alt me-2"></i>
                <span>{{ hotel.suburb|default:hotel.city }}</span>
            </div>
        </div>
    </div>
</div>

<div class="container mt-4">
    <div class="row">
        <!-- Main Content -->
        <div class="col-lg-9 mb-4">
            
            
            <!-- Rooms Section with Filters and Grid -->
            <div class="rooms-section">
                <!-- Rooms Header with Controls -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h3 class="mb-1"><i class="fas fa-bed me-2 text-primary"></i>Available Rooms</h3>
                        <small class="text-muted">
                            <span id="rooms-count">{{ hotel.rooms.all|length }}</span> room{{ hotel.rooms.all|length|pluralize }} available
                        </small>
                    </div>
                    
                    <!-- View Toggle -->
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-outline-secondary btn-sm active" id="grid-view" onclick="toggleView('grid')">
                            <i class="fas fa-th"></i>
                        </button>
                        <button type="button" class="btn btn-outline-secondary btn-sm" id="list-view" onclick="toggleView('list')">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Filters -->
                <div class="card mb-4">
                    <div class="card-body py-3">
                        <div class="row align-items-center">
                            <div class="col-md-4 mb-2 mb-md-0">
                                <select class="form-select form-select-sm" id="capacity-filter">
                                    <option value="">Any Capacity</option>
                                    <option value="1">1 Guest</option>
                                    <option value="2">2 Guests</option>
                                    <option value="3">3 Guests</option>
                                    <option value="4">4+ Guests</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-2 mb-md-0">
                                <select class="form-select form-select-sm" id="price-filter">
                                    <option value="">Any Price</option>
                                    <option value="0-3000">₦0 - ₦3,000</option>
                                    <option value="3000-5000">₦3,000 - ₦5,000</option>
                                    <option value="5000-10000">₦5,000 - ₦10,000</option>
                                    <option value="10000+">₦10,000+</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <select class="form-select form-select-sm" id="availability-filter">
                                    <option value="">All Rooms</option>
                                    <option value="available">Available Only</option>
                                    <option value="unavailable">Unavailable Only</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Rooms Grid/List Container -->
                <div id="rooms-container" class="rooms-grid">
                    {% for room in hotel.rooms.all %}
                        <div class="room-item" 
                             data-room-type="{{ room.room_type|lower }}" 
                             data-capacity="{{ room.capacity }}" 
                             data-price="{{ room.price_per_hour }}"
                             data-availability="{% if room.is_available %}available{% else %}unavailable{% endif %}">
                            
                            <!-- Grid View Card -->
                            <div class="room-card-grid">
                                <div class="room-image-container">
                                    {% if room.image %}
                                        <img src="{{ room.image.url }}" alt="{{ room.room_type }}" class="room-image">
                                    {% else %}
                                        <div class="room-image-placeholder">
                                            <i class="fas fa-bed fa-2x text-muted"></i>
                                        </div>
                                    {% endif %}
                                    
                                    <!-- Availability Badge -->
                                    <div class="availability-badge">
                                        <span class="badge {% if room.is_available %}bg-success{% else %}bg-secondary{% endif %}">
                                            {% if room.is_available %}Available{% else %}Booked{% endif %}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="room-content p-3">
                                    <h6 class="room-title mb-2">{{ room.room_type }}</h6>
                                    
                                    <div class="room-details mb-2">
                                        <small class="text-muted">
                                            <i class="fas fa-users me-1"></i>{{ room.capacity }} guest{{ room.capacity|pluralize }}
                                        </small>
                                    </div>
                                    
                                    <p class="room-description">{{ room.description|truncatewords:8 }}</p>
                                    
                                    <!-- Amenities -->
                                    <div class="amenities mb-3">
                                        <span class="amenity-badge"><i class="fas fa-snowflake"></i></span>
                                        <span class="amenity-badge"><i class="fas fa-wifi"></i></span>
                                        <span class="amenity-badge"><i class="fas fa-tv"></i></span>
                                        <span class="amenity-badge"><i class="fas fa-bath"></i></span>
                                    </div>
                                    
                                    <!-- Price and Booking -->
                                    <div class="room-footer">
                                        <div class="price-section mb-2">
                                            <span class="price">₦{{ room.price_per_hour|floatformat:0 }}</span>
                                            <span class="price-unit">/hour</span>
                                        </div>
                                        
                                        {% if room.is_available %}
                                            <a href="{% url 'book_room' room.id %}" class="btn btn-primary btn-sm w-100">
                                                <i class="fas fa-calendar-check me-1"></i>Book Now
                                            </a>
                                        {% else %}
                                            <button class="btn btn-secondary btn-sm w-100" disabled>
                                                <i class="fas fa-ban me-1"></i>Not Available
                                            </button>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- List View Card (hidden by default) -->
                            <div class="room-card-list" style="display: none;">
                                <div class="row g-0">
                                    <div class="col-md-3">
                                        <div class="room-image-container-list">
                                            {% if room.image %}
                                                <img src="{{ room.image.url }}" alt="{{ room.room_type }}" class="room-image">
                                            {% else %}
                                                <div class="room-image-placeholder">
                                                    <i class="fas fa-bed fa-2x text-muted"></i>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-md-6 p-3">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <h6 class="mb-0">{{ room.room_type }}</h6>
                                            <span class="badge {% if room.is_available %}bg-success{% else %}bg-secondary{% endif %}">
                                                {% if room.is_available %}Available{% else %}Booked{% endif %}
                                            </span>
                                        </div>
                                        
                                        <div class="mb-2">
                                            <small class="text-muted">
                                                <i class="fas fa-users me-1"></i>{{ room.capacity }} guest{{ room.capacity|pluralize }}
                                            </small>
                                        </div>
                                        
                                        <p class="mb-2">{{ room.description|truncatewords:15 }}</p>
                                        
                                        <div class="amenities">
                                            <span class="amenity-badge"><i class="fas fa-snowflake"></i> AC</span>
                                            <span class="amenity-badge"><i class="fas fa-wifi"></i> WiFi</span>
                                            <span class="amenity-badge"><i class="fas fa-tv"></i> TV</span>
                                            <span class="amenity-badge"><i class="fas fa-bath"></i> Bath</span>
                                        </div>
                                    </div>
                                    <div class="col-md-3 p-3 bg-light d-flex flex-column justify-content-center">
                                        <div class="text-center mb-2">
                                            <span class="price">₦{{ room.price_per_hour|floatformat:0 }}</span>
                                            <span class="price-unit d-block">/hour</span>
                                        </div>
                                        
                                        {% if room.is_available %}
                                            <a href="{% url 'book_room' room.id %}" class="btn btn-primary btn-sm">
                                                <i class="fas fa-calendar-check me-1"></i>Book Now
                                            </a>
                                        {% else %}
                                            <button class="btn btn-secondary btn-sm" disabled>
                                                <i class="fas fa-ban me-1"></i>Not Available
                                            </button>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% empty %}
                        <div class="col-12">
                            <div class="alert alert-info text-center">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>No rooms available</strong><br>
                                <small>Please check back later.</small>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <!-- No Results Message -->
                <div id="no-results" class="alert alert-warning text-center" style="display: none;">
                    <i class="fas fa-search me-2"></i>
                    <strong>No rooms match your filters</strong><br>
                    <small>Try adjusting your search criteria</small>
                </div>
            </div>
        </div>
        
        <!-- Sidebar -->
        <div class="col-lg-3">
            <!-- Room Summary -->
            <div class="card shadow-sm sticky-top" style="top: 20px;">
                <div class="card-header bg-light">
                    <h6 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Room Summary</h6>
                </div>
                <div class="card-body">
                    <div class="summary-item">
                        <span class="summary-label">Total Rooms:</span>
                        <span class="summary-value">{{ hotel.rooms.all|length }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Available:</span>
                        <span class="summary-value text-success">{{ hotel.rooms.all|length }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Guest Reviews Section -->
<section id="hotel-reviews" class="py-5 mt-5">
  <div class="container">
    <h2 class="text-center fw-bold mb-5">Hotel Reviews</h2>

    {% if reviews %}
      <div class="reviews-container d-flex flex-nowrap overflow-auto pb-3">
        {% for review in reviews %}
          <div class="review-card">
            <div class="card shadow-sm border-0">
              <div class="card-body text-center">
                <h6 class="card-title fw-bold mb-2">{{ review.name }}</h6>
                <div class="text-warning mb-3">
                  {% for i in "12345"|make_list %}
                    {% if review.rating|add:'0' >= i|add:'0' %}
                      <i class="fas fa-star"></i>
                    {% else %}
                      <i class="far fa-star"></i>
                    {% endif %}
                  {% endfor %}
                </div>
                <p class="card-text text-muted">{{ review.review_text }}</p>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-4">
        <div class="mb-3">
          <i class="fas fa-comments fa-2x text-muted mb-2"></i>
          <h5 class="text-muted">No reviews yet</h5>
          <p class="text-muted mb-0">Be the first to share your experience!</p>
        </div>
      </div>
    {% endif %}

    <!-- Review Form -->
    <div class="mt-4">
      <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
          <div class="card shadow-sm border-0">
            <div class="card-header bg-white text-center border-bottom">
              <h5 class="fw-bold mb-1 text-dark">Leave a Review</h5>
              <small class="text-muted">Share your experience with other guests</small>
            </div>
            <div class="card-body p-3">
              <form method="post" action="{% url 'hotel_detail' hotel.slug %}">

                {% csrf_token %}
                {{ review_form.non_field_errors }}
                
                <div class="mb-3">
                  <label for="{{ review_form.name.id_for_label }}" class="form-label fw-semibold">Name</label>
                  {{ review_form.name }}
                  {{ review_form.name.errors }}
                </div>
                <!-- ADD THIS EMAIL FIELD -->
<div class="mb-3">
    <label for="{{ review_form.email.id_for_label }}" class="form-label fw-semibold">Email</label>
    {{ review_form.email }}
    {{ review_form.email.errors }}
</div>
                
                <div class="mb-3">
                  <label for="{{ review_form.rating.id_for_label }}" class="form-label fw-semibold">Rating</label>
                  <select class="form-select" id="{{ review_form.rating.id_for_label }}" name="{{ review_form.rating.name }}" required>
                    <option value="">Select Rating</option>
                    <option value="5">⭐⭐⭐⭐⭐ (5 - Excellent)</option>
                    <option value="4">⭐⭐⭐⭐ (4 - Very Good)</option>
                    <option value="3">⭐⭐⭐ (3 - Good)</option>
                    <option value="2">⭐⭐ (2 - Fair)</option>
                    <option value="1">⭐ (1 - Poor)</option>
                  </select>
                  {{ review_form.rating.errors }}
                </div>
                
                <div class="mb-3">
                  <label for="{{ review_form.review_text.id_for_label }}" class="form-label fw-semibold">Review</label>
                  {{ review_form.review_text }}
                  {{ review_form.review_text.errors }}
                </div>
                
                <div class="text-center">
                  <button type="submit" class="btn btn-primary px-4">
                    <i class="fas fa-paper-plane me-1"></i>Submit Review
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
</section>

<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


<style>
    /* Hero section styles */
    .hotel-hero-image {
        height: 400px;
        background-size: cover;
        background-position: center;
        position: relative;
    }
    
    .hotel-hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.7));
    }
    
    .hotel-hero-content {
        padding: 2rem 0;
        position: absolute;
        bottom: 0;
        width: 100%;
    }
    
    /* Rooms Grid Layout */
    .rooms-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
    }
    
    .rooms-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    
    /* Room Card Styles */
    .room-card-grid {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    
    .room-card-grid:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    .room-card-list {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        margin-bottom: 1rem;
    }
    
    .room-card-list:hover {
        box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    }
    
    /* Room Image Styles */
    .room-image-container {
        height: 200px;
        position: relative;
        overflow: hidden;
    }
    
    .room-image-container-list {
        height: 150px;
        overflow: hidden;
    }
    
    .room-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .room-image-placeholder {
        width: 100%;
        height: 100%;
        background: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .availability-badge {
        position: absolute;
        top: 10px;
        right: 10px;
    }
    
    /* Room Content */
    .room-content {
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    
    .room-title {
        font-weight: 600;
        color: #2c3e50;
    }
    
    .room-description {
        font-size: 0.875rem;
        color: #6c757d;
        flex: 1;
    }
    
    /* Amenities */
    .amenities {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
    }
    
    .amenity-badge {
        background: #f8f9fa;
        color: #6c757d;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.75rem;
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
    }
    
    /* Price Styles */
    .price {
        font-size: 1.25rem;
        font-weight: 700;
        color: #28a745;
    }
    
    .price-unit {
        font-size: 0.875rem;
        color: #6c757d;
    }
    
    /* Summary Styles */
    .summary-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 0;
        border-bottom: 1px solid #f1f3f4;
    }
    
    .summary-item:last-child {
        border-bottom: none;
    }
    
    .summary-label {
        font-size: 0.875rem;
        color: #6c757d;
    }
    
    .summary-value {
        font-weight: 600;
    }
    
    /* Enhanced Reviews Section Styles */
    #hotel-reviews {
        background: linear-gradient(180deg, #e9ecef 0%, #ffffff 100%);

        border-radius: 0;
    }
    
    #hotel-reviews h2 {
        color: #121643;
        font-size: 2.2rem;
        font-weight: 700;
        position: relative;
        margin-bottom: 2.5rem;
    }
    
    #hotel-reviews h2:after {
        content: '';
        position: absolute;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: #ffd700;
        border-radius: 2px;
    }
    
    /* Smaller, completely white review cards */
    /* Same style as homepage */
.review-card {
    flex: 0 0 280px;
    margin-right: 20px;
    scroll-snap-align: start;
}
    
    .review-card .card {
    height: 180px;
    border-radius: 15px;
    background: white;
    border: 1px solid #e9ecef;
    position: relative;
    overflow: hidden;
}

    
    .review-card .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(18, 22, 67, 0.1);
        border-color: #121643;
    }
    
    .review-card .card-body {
        padding: 1.5rem 1.25rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
        height: 100%;
    }
    
    /* Truncate or wrap names */
.review-card .card-title {
    color: #121643;
    font-size: 1rem;
    margin-bottom: 0.75rem;
    white-space: normal;
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
}
    
    .review-card .text-warning {
        margin-bottom: 1rem;
    }
    
    .review-card .text-warning i {
        font-size: 0.9rem;
        margin-right: 1px;
        color: #ffd700;
    }
    
    .review-card .card-text {
        font-size: 0.85rem;
        line-height: 1.4;
        color: #6c757d;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        line-clamp: 3;
        -webkit-box-orient: vertical;
    }
    
    /* Compact form styling */
    #hotel-reviews .card-header {
        background: white;
        color: #121643;
        border-bottom: 1px solid #e9ecef;
        padding: 1rem;
    }
    
    #hotel-reviews .card-header h5 {
        color: #121643;
        margin-bottom: 0.25rem;
    }
    
    #hotel-reviews .btn-primary {
        background: #121643;
        border: none;
        padding: 8px 20px;
        font-weight: 600;
        transition: all 0.3s ease;
        border-radius: 8px;
    }
    
    #hotel-reviews .btn-primary:hover {
        background: #0e123a;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(18, 22, 67, 0.2);
    }
    
    #hotel-reviews .form-control:focus,
    #hotel-reviews .form-select:focus {
        border-color: #121643;
        box-shadow: 0 0 0 0.2rem rgba(18, 22, 67, 0.15);
    }
    
    #hotel-reviews .form-label {
        color: #495057;
        font-size: 0.9rem;
    }
    
    /* Enhanced star rating dropdown */
    #id_rating option {
        padding: 8px;
        font-size: 0.95rem;
    }
    
    /* Responsive adjustments for smaller cards */
    @media (max-width: 768px) {
        .rooms-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .hotel-hero-image {
            height: 300px;
        }
        
        .hotel-hero-content h1 {
            font-size: 2rem;
        }
        
        .room-image-container {
            height: 150px;
        }
        
        #hotel-reviews h2 {
            font-size: 2rem;
            margin-bottom: 2rem;
        }
        
        .review-card {
            flex: 0 0 250px;
            margin-right: 15px;
        }
        
        .review-card .card {
            height: 160px;
        }
        
        .review-card .card-body {
            padding: 1.25rem 1rem;
        }
        
        .review-card .card-title {
            font-size: 0.95rem;
        }
        
        .review-card .card-text {
            font-size: 0.8rem;
            -webkit-line-clamp: 2;
            line-clamp: 2;
        }
    }
    
    @media (max-width: 576px) {
        .hotel-hero-image {
            height: 250px;
        }
        
        .rooms-grid {
            gap: 0.75rem;
        }
        
        #hotel-reviews {
            padding: 3rem 0;
        }
        
        #hotel-reviews h2 {
            font-size: 1.8rem;
        }
        
        .review-card {
            flex: 0 0 220px;
            margin-right: 12px;
        }
        
        .review-card .card {
            height: 150px;
        }
        
        .review-card .card-body {
            padding: 1rem 0.875rem;
        }
        
        .review-card .text-warning i {
            font-size: 0.8rem;
        }
        
        .review-card .card-text {
            font-size: 0.75rem;
        }
        
        #hotel-reviews .btn-primary {
            padding: 10px 25px;
            font-size: 0.95rem;
        }
    }
    
    /* Filter animations */
    .room-item {
        transition: all 0.3s ease;
    }
    
    .room-item.hidden {
        display: none;
    }
    
    /* View toggle buttons */
    .btn-group .btn.active {
        background-color: #007bff;
        color: white;
        border-color: #007bff;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    const successToast = new bootstrap.Toast(document.getElementById('successToast'));
    const errorToast = new bootstrap.Toast(document.getElementById('errorToast'));
    
    // Show toast if there's a success message from Django
    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'success' %}
                // Show success toast immediately
                successToast.show();
            {% elif message.tags == 'error' %}
                document.getElementById('errorToastMessage').textContent = '{{ message }}';
                errorToast.show();
            {% endif %}
        {% endfor %}
    {% endif %}

    // Add loading state to form submission
    const reviewForm = document.querySelector('#hotel-reviews form');
    if (reviewForm) {
        reviewForm.addEventListener('submit', function(e) {
            const submitButton = reviewForm.querySelector('button[type="submit"]');
            const originalText = submitButton.innerHTML;
            
            // Show loading state
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Submitting...';
            submitButton.disabled = true;
            
            // Form will submit normally and page will reload
            // The toast will show on the reloaded page
        });
    }
    // View Toggle Functionality
    function toggleView(viewType) {
        const container = document.getElementById('rooms-container');
        const gridBtn = document.getElementById('grid-view');
        const listBtn = document.getElementById('list-view');
        const roomItems = document.querySelectorAll('.room-item');
        
        if (viewType === 'grid') {
            container.className = 'rooms-grid';
            gridBtn.classList.add('active');
            listBtn.classList.remove('active');
            
            roomItems.forEach(item => {
                item.querySelector('.room-card-grid').style.display = 'flex';
                item.querySelector('.room-card-list').style.display = 'none';
            });
        } else {
            container.className = 'rooms-list';
            listBtn.classList.add('active');
            gridBtn.classList.remove('active');
            
            roomItems.forEach(item => {
                item.querySelector('.room-card-grid').style.display = 'none';
                item.querySelector('.room-card-list').style.display = 'block';
            });
        }
    }
    
    // Filter Functionality
    function filterRooms() {
        const capacityFilter = document.getElementById('capacity-filter').value;
        const priceFilter = document.getElementById('price-filter').value;
        const availabilityFilter = document.getElementById('availability-filter').value;
        
        const roomItems = document.querySelectorAll('.room-item');
        let visibleCount = 0;
        
        roomItems.forEach(item => {
            let show = true;
            
            // Capacity filter
            if (capacityFilter) {
                const capacity = parseInt(item.dataset.capacity);
                const filterCapacity = parseInt(capacityFilter);
                if (filterCapacity === 4 && capacity < 4) show = false;
                else if (filterCapacity !== 4 && capacity !== filterCapacity) show = false;
            }
            
            // Price filter
            if (priceFilter) {
                const price = parseInt(item.dataset.price);
                const [min, max] = priceFilter.split('-').map(p => parseInt(p.replace('+', '')));
                
                if (priceFilter.includes('+')) {
                    if (price < min) show = false;
                } else {
                    if (price < min || price > max) show = false;
                }
            }
            
            // Availability filter
            if (availabilityFilter && item.dataset.availability !== availabilityFilter) {
                show = false;
            }
            
            if (show) {
                item.style.display = 'block';
                item.classList.remove('hidden');
                visibleCount++;
            } else {
                item.style.display = 'none';
                item.classList.add('hidden');
            }
        });
        
        // Update count
        document.getElementById('rooms-count').textContent = visibleCount;
        
        // Show/hide no results message
        const noResults = document.getElementById('no-results');
        if (visibleCount === 0) {
            noResults.style.display = 'block';
        } else {
            noResults.style.display = 'none';
        }
    }
    
    // Add event listeners for filters
    document.addEventListener('DOMContentLoaded', function() {
        const filters = ['capacity-filter', 'price-filter', 'availability-filter'];
        filters.forEach(filterId => {
            document.getElementById(filterId).addEventListener('change', filterRooms);
        });
    });
    
    // Share Hotel Function
    function shareHotel() {
        if (navigator.share) {
            navigator.share({
                title: '{{ hotel.name }}',
                text: 'Check out this hotel: {{ hotel.name }}',
                url: window.location.href
            });
        } else {
            navigator.clipboard.writeText(window.location.href).then(() => {
                alert('Hotel link copied to clipboard!');
            });
        }
    }
});
</script>
{% endblock %}
